---
title: "QB Points Discovery"
author: "Jack DePree"
date: "2023-02-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(tidyverse)
pff_pass_12 <- read_csv("pff_passing_summary_2012.csv", show_col_types = FALSE)
pff_pass_13 <- read_csv("pff_passing_summary_2013.csv", show_col_types = FALSE)
pff_pass_14 <- read_csv("pff_passing_summary_2014.csv", show_col_types = FALSE)
pff_pass_15 <- read_csv("pff_passing_summary_2015.csv", show_col_types = FALSE)
pff_pass_16 <- read_csv("pff_passing_summary_2016.csv", show_col_types = FALSE)
pff_pass_17 <- read_csv("pff_passing_summary_2017.csv", show_col_types = FALSE)
pff_pass_18 <- read_csv("pff_passing_summary_2018.csv", show_col_types = FALSE)
pff_pass_19 <- read_csv("pff_passing_summary_2019.csv", show_col_types = FALSE)
pff_pass_20 <- read_csv("pff_passing_summary_2020.csv", show_col_types = FALSE)
pff_pass_21 <- read_csv("pff_passing_summary_2021.csv", show_col_types = FALSE)
pff_pass_22 <- read_csv("pff_passing_summary_2022.csv", show_col_types = FALSE)
pfr_pass_12 <- read_csv("2012_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_13 <- read_csv("2013_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_14 <- read_csv("2014_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_15 <- read_csv("2015_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_16 <- read_csv("2016_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_17 <- read_csv("2017_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_18 <- read_csv("2018_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_19 <- read_csv("2019_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_20 <- read_csv("2020_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_21 <- read_csv("2021_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pfr_pass_22 <- read_csv("2022_nfl_passing_profootballreference.csv", show_col_types=FALSE)
pff_rush_12 <- read_csv("pff_rushing_summary_2012.csv", show_col_types = FALSE)
pff_rush_13 <- read_csv("pff_rushing_summary_2013.csv", show_col_types = FALSE)
pff_rush_14 <- read_csv("pff_rushing_summary_2014.csv", show_col_types = FALSE)
pff_rush_15 <- read_csv("pff_rushing_summary_2015.csv", show_col_types = FALSE)
pff_rush_16 <- read_csv("pff_rushing_summary_2016.csv", show_col_types = FALSE)
pff_rush_17 <- read_csv("pff_rushing_summary_2017.csv", show_col_types = FALSE)
pff_rush_18 <- read_csv("pff_rushing_summary_2018.csv", show_col_types = FALSE)
pff_rush_19 <- read_csv("pff_rushing_summary_2019.csv", show_col_types = FALSE)
pff_rush_20 <- read_csv("pff_rushing_summary_2020.csv", show_col_types = FALSE)
pff_rush_21 <- read_csv("pff_rushing_summary_2021.csv", show_col_types = FALSE)
pff_rush_22 <- read_csv("pff_rushing_summary_2022.csv", show_col_types = FALSE)
adp_12 <- read_csv("2012_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_13 <- read_csv("2013_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_14 <- read_csv("2014_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_15 <- read_csv("2015_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_16 <- read_csv("2016_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_17 <- read_csv("2017_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_18 <- read_csv("2018_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_19 <- read_csv("2019_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_20 <- read_csv("2020_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_21 <- read_csv("2021_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_22 <- read_csv("2022_fantasypros_qb_adp.csv", show_col_types=FALSE)
adp_23 <- read_csv("2023_fantasypros_qb_adp.csv", show_col_types=FALSE)
```

```{r}
oline_12 <- read_csv("2012 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_13 <- read_csv("2013 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_14 <- read_csv("2014 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_15 <- read_csv("2015 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_16 <- read_csv("2016 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_17 <- read_csv("2017 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_18 <- read_csv("2018 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_19 <- read_csv("2019 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_20 <- read_csv("2020 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_21 <- read_csv("2021 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_22 <- read_csv("2022 Basic Offensive Line Stats.csv", show_col_types=FALSE)
oline_12 <- oline_12 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_13 <- oline_13 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_14 <- oline_14 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_15 <- oline_15 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_16 <- oline_16 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_17 <- oline_17 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_18 <- oline_18 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_19 <- oline_19 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_20 <- oline_20 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_21 <- oline_21 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
oline_22 <- oline_22 %>%
  separate(col=PowerSuccess, into=c('PowerSuccess', NA), sep="%", convert=TRUE) %>%
  separate(col=Stuffed, into=c('Stuffed', NA), sep="%", convert=TRUE) %>%
  separate(col=`AdjustedSack Rate`, into=c('AdjustedSackRate', NA), sep="%", convert=TRUE)
```

```{r}
dvoa_12 <- read_csv("2012 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_13 <- read_csv("2013 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_14 <- read_csv("2014 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_15 <- read_csv("2015 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_16 <- read_csv("2016 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_17 <- read_csv("2017 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_18 <- read_csv("2018 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_19 <- read_csv("2019 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_20 <- read_csv("2020 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_21 <- read_csv("2021 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_22 <- read_csv("2022 Team DVOA Ratings Offense.csv", show_col_types=FALSE)
dvoa_12 <- dvoa_12 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_13 <- dvoa_13 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_14 <- dvoa_14 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_15 <- dvoa_15 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_16 <- dvoa_16 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_17 <- dvoa_17 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_18 <- dvoa_18 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_19 <- dvoa_19 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_20 <- dvoa_20 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_21 <- dvoa_21 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
dvoa_22 <- dvoa_22 %>%
  separate(col=`Total DVOA`, into=c('Total_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Weighted DVOA`, into=c('Weighted_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Pass DVOA`, into=c('Pass_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Rush DVOA`, into=c('Rush_DVOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Total VOA`, into=c('Unadj_Total_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Pass VOA`, into=c('Unadj_Pass_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Unadj. Rush VOA`, into=c('Unadj_Rush_VOA', NA), sep="%", convert=TRUE) %>%
  separate(col=`Variance`, into=c('Variance', NA), sep="%", convert=TRUE) %>%
  separate(col=`Schedule`, into=c('Schedule', NA), sep="%", convert=TRUE)
```

Data Transposition

```{r}
pff_12 <- merge(pff_pass_12, pff_rush_12, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_13 <- merge(pff_pass_13, pff_rush_13, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_14 <- merge(pff_pass_14, pff_rush_14, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_15 <- merge(pff_pass_15, pff_rush_15, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_16 <- merge(pff_pass_16, pff_rush_16, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_17 <- merge(pff_pass_17, pff_rush_17, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_18 <- merge(pff_pass_18, pff_rush_18, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_19 <- merge(pff_pass_19, pff_rush_19, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_20 <- merge(pff_pass_20, pff_rush_20, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_21 <- merge(pff_pass_21, pff_rush_21, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
pff_22 <- merge(pff_pass_22, pff_rush_22, by="player", all=TRUE, suffixes=c("_pass", "_rush"))
qb_12 <- merge(pff_12, pfr_pass_12, by.x="player", by.y="Player", all=TRUE)
qb_13 <- merge(pff_13, pfr_pass_13, by.x="player", by.y="Player", all=TRUE)
qb_14 <- merge(pff_14, pfr_pass_14, by.x="player", by.y="Player", all=TRUE)
qb_15 <- merge(pff_15, pfr_pass_15, by.x="player", by.y="Player", all=TRUE)
qb_16 <- merge(pff_16, pfr_pass_16, by.x="player", by.y="Player", all=TRUE)
qb_17 <- merge(pff_17, pfr_pass_17, by.x="player", by.y="Player", all=TRUE)
qb_18 <- merge(pff_18, pfr_pass_18, by.x="player", by.y="Player", all=TRUE)
qb_19 <- merge(pff_19, pfr_pass_19, by.x="player", by.y="Player", all=TRUE)
qb_20 <- merge(pff_20, pfr_pass_20, by.x="player", by.y="Player", all=TRUE)
qb_21 <- merge(pff_21, pfr_pass_21, by.x="player", by.y="Player", all=TRUE)
qb_22 <- merge(pff_22, pfr_pass_22, by.x="player", by.y="Player", all=TRUE)
qb_12 <- merge(qb_12, adp_13, by.x="player", by.y="Player", all=TRUE)
qb_13 <- merge(qb_13, adp_14, by.x="player", by.y="Player", all=TRUE)
qb_14 <- merge(qb_14, adp_15, by.x="player", by.y="Player", all=TRUE)
qb_15 <- merge(qb_15, adp_16, by.x="player", by.y="Player", all=TRUE)
qb_16 <- merge(qb_16, adp_17, by.x="player", by.y="Player", all=TRUE)
qb_17 <- merge(qb_17, adp_18, by.x="player", by.y="Player", all=TRUE)
qb_18 <- merge(qb_18, adp_19, by.x="player", by.y="Player", all=TRUE)
qb_19 <- merge(qb_19, adp_20, by.x="player", by.y="Player", all=TRUE)
qb_20 <- merge(qb_20, adp_21, by.x="player", by.y="Player", all=TRUE)
qb_21 <- merge(qb_21, adp_22, by.x="player", by.y="Player", all=TRUE)
qb_22 <- merge(qb_22, adp_23, by.x="player", by.y="Player", all=TRUE)
qb_12 <- merge(qb_12, oline_12, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_13 <- merge(qb_13, oline_13, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_14 <- merge(qb_14, oline_14, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_15 <- merge(qb_15, oline_15, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_16 <- merge(qb_16, oline_16, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_17 <- merge(qb_17, oline_17, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_18 <- merge(qb_18, oline_18, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_19 <- merge(qb_19, oline_19, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_20 <- merge(qb_20, oline_20, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_21 <- merge(qb_21, oline_21, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_22 <- merge(qb_22, oline_22, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_12 <- merge(qb_12, dvoa_12, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_13 <- merge(qb_13, dvoa_13, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_14 <- merge(qb_14, dvoa_14, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_15 <- merge(qb_15, dvoa_15, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_16 <- merge(qb_16, dvoa_16, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_17 <- merge(qb_17, dvoa_17, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_18 <- merge(qb_18, dvoa_18, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_19 <- merge(qb_19, dvoa_19, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_20 <- merge(qb_20, dvoa_20, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_21 <- merge(qb_21, dvoa_21, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_22 <- merge(qb_22, dvoa_22, by.x="team_name_pass", by.y="Team", all=TRUE)
qb_12 <- filter(qb_12, position_pass=="QB")
qb_13 <- filter(qb_13, position_pass=="QB")
qb_14 <- filter(qb_14, position_pass=="QB")
qb_15 <- filter(qb_15, position_pass=="QB")
qb_16 <- filter(qb_16, position_pass=="QB")
qb_17 <- filter(qb_17, position_pass=="QB")
qb_18 <- filter(qb_18, position_pass=="QB")
qb_19 <- filter(qb_19, position_pass=="QB")
qb_20 <- filter(qb_20, position_pass=="QB")
qb_21 <- filter(qb_21, position_pass=="QB")
qb_22 <- filter(qb_22, position_pass=="QB")
```

Mutations

```{r}
qb_12 <- qb_12 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_13 <- qb_13 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_14 <- qb_14 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_15 <- qb_15 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_16 <- qb_16 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_17 <- qb_17 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_18 <- qb_18 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_19 <- qb_19 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_20 <- qb_20 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_21 <- qb_21 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)
qb_22 <- qb_22 %>%
  mutate(fantasy_points=(yards_pass*.04)+(touchdowns_pass*4)+(interceptions*-2)+(fumbles*-2)+(yards_rush*.1)+(touchdowns_rush*6)) %>%
  mutate(fp_over_age=fantasy_points / Age) %>%
  mutate(rushes_by_sacks=attempts_rush - sacks) %>%
  mutate(QBR_and_rushes=QBR + attempts_rush) %>%
  mutate(accurate_passes=accuracy_percent * attempts_pass * .01) %>%
  mutate(all_touchdowns_by_int_by_sacks=touchdowns_pass + touchdowns_rush - interceptions - sacks) %>%
  mutate(adot_and_touchdowns_rush=avg_depth_of_target + touchdowns_rush) %>%
  mutate(sum_of_longest=longest + Lng)

qb_12_13 <- merge(qb_12, qb_13, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_13_14 <- merge(qb_13, qb_14, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_14_15 <- merge(qb_14, qb_15, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_15_16 <- merge(qb_15, qb_16, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_16_17 <- merge(qb_16, qb_17, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_17_18 <- merge(qb_17, qb_18, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_18_19 <- merge(qb_18, qb_19, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_19_20 <- merge(qb_19, qb_20, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_20_21 <- merge(qb_20, qb_21, by="player", all=TRUE, suffixes=c(".x",".y"))
qb_21_22 <- merge(qb_21, qb_22, by="player", all=TRUE, suffixes=c(".x",".y"))
```

Data Cleaning

```{r}
qb_12_22 <- rbind(qb_12_13, qb_13_14, qb_14_15, qb_15_16, qb_16_17, qb_17_18, qb_18_19, qb_19_20, qb_20_21, qb_20_21)
qb_12_22 <- select(qb_12_22, -c(player_id_pass.x, declined_penalties_pass.x, grades_hands_fumble_pass.x, franchise_id_pass.x, player_game_count_rush.x, declined_penalties_rush.x, drops_rush.x, elu_recv_mtf.x, franchise_id_rush.x, grades_pass_rush.x, player_id_rush.x, position_rush.x, team_name_rush.x, grades_offense_rush.x, grades_pass_block.x, grades_pass_route.x, grades_run_block.x, penalties_rush.x, rec_yards.x, receptions.x, routes.x, targets.x, yprr.x, "Player-additional.x", 
                                
                                player_id_pass.y, declined_penalties_pass.y, grades_hands_fumble_pass.y, franchise_id_pass.y, player_game_count_rush.y, declined_penalties_rush.y, drops_rush.y, elu_recv_mtf.y, franchise_id_rush.y, grades_pass_rush.y, player_id_rush.y, position_rush.y, team_name_rush.y, grades_offense_rush.y, grades_pass_block.y, grades_pass_route.y, grades_run_block.y, penalties_rush.y, rec_yards.y, receptions.y, routes.y, targets.y, yprr.y, "Player-additional.y"))
#colnames(qb_12_22)[longest.x] <- 'longest_run.x'
#colnames(qb_12_22)[longest.y] <- 'longest_run.y'
#colnames(qb_12_22)[Lng.x] <- 'Lng_pass.x'
#colnames(qb_12_22)[Lng.y] <- 'Lng_pass.y'
qb_12_22 <- filter(qb_12_22, attempts_pass.x>=100)
qb_12_22
```

Correlation Testing

Hypothetical Mutations:
  Points controlled by Age (fantasy_points / age)
  Rushing Attempts controlled by Sacks (attempts_rush - sacks)
  QBR plus Rushing Attempts (QBR + attempts_rush)
  Accurate Passes (accuracy_percent * attempts_pass)
  All Touchdowns controlled by Interceptions and Sacks (touchdowns_pass + touchdowns_rush - interceptions - sacks)
  ADoT plus Rushing Touchdowns (avg_depth_of_target + touchdowns_rush)
  Sum of Longest Plays (longest + Lng)

```{r}
cor.current <- c()
cor.future <- c()
cor.df <- data.frame()
for (i in 4:120) {
  x <- cor(qb_12_22[,i], qb_12_22$fantasy_points.x, use="complete.obs")
  cor.current <- c(cor.current, x)
}
for (i in 4:120) {
  x <- cor(qb_12_22[,i], qb_12_22$fantasy_points.y, use="complete.obs")
  cor.future <- c(cor.future, x)
}
cor.df <- data.frame(variable=colnames(qb_12_22[,4:120]), cor.current, cor.future)
cor.df <- mutate(cor.df, percent.change=100*(cor.future-cor.current)/cor.current)
good.cor.df <- filter(cor.df, cor.current>=.1 | cor.current<=-.1)
best.cor.df <- filter(cor.df, cor.current>=.5 | cor.current<=-.5)
bad.cor.df <- filter(cor.df, cor.current<.1 & cor.current>-.1)
cor.df
#good.cor.df
#best.cor.df
#bad.cor.df
```

```{r}
ggplot(qb_12_22) +
  geom_point(aes(y=fantasy_points.y, x=rushes_by_sacks.x), colour='purple') +
  geom_point(aes(y=fantasy_points.y, x=all_touchdowns_by_int_by_sacks.x), colour='darkgreen') +
  geom_point(aes(y=fantasy_points.y, x=accurate_passes.x), colour='brown')
```


